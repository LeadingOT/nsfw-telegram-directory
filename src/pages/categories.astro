---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const listings = await getCollection('listings');
const categoryMap = new Map<string, number>();
listings.forEach((l) => {
  const count = categoryMap.get(l.data.category) || 0;
  categoryMap.set(l.data.category, count + 1);
});
const categories = [...categoryMap.entries()].sort((a, b) => b[1] - a[1]);

const categoryEmojis: Record<string, string> = {
  'Adult Content Channels': 'ğŸ”',
  'OnlyFans & Creator Leaks': 'ğŸ“¸',
  'Dating & Hookup Groups': 'ğŸ’•',
  'NSFW Bots': 'ğŸ¤–',
  'Hentai & Anime': 'ğŸŒ',
  'NSFW Stickers': 'ğŸ˜ˆ',
  'Gay & LGBTQ+': 'ğŸ³ï¸â€ğŸŒˆ',
  'Couples & Swinger Groups': 'ğŸ’‘',
};
---

<BaseLayout title="All Categories â€” NSFW Telegram Directory" description="Browse all NSFW Telegram channel categories including adult content, dating groups, NSFW bots, hentai, stickers, LGBTQ+, and more.">
  <h1 class="text-3xl font-bold mb-8">All Categories</h1>
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    {categories.map(([cat, count]) => (
      <a
        href={`/category/${cat.toLowerCase().replace(/[&+]/g, '').replace(/\s+/g, '-')}`}
        class="block border border-gray-800 rounded-lg p-5 hover:shadow-lg hover:border-purple-600 transition-all bg-gray-900"
      >
        <h2 class="text-lg font-semibold">{categoryEmojis[cat] || 'ğŸ“‚'} {cat}</h2>
        <p class="text-sm text-gray-500">{count} channels & groups</p>
      </a>
    ))}
  </div>
</BaseLayout>
